<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube 채널 모니터</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="header-content">
                <h1>YouTube 채널 모니터</h1>
                <div class="api-status">
                    <span id="api-status-text">API 키 설정 필요</span>
                    <button id="api-settings-btn" class="settings-btn">⚙️</button>
                </div>
            </div>
        </header>

        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="channel-monitor">채널 모니터링</button>
            <button class="tab-btn" data-tab="video-search">영상 검색</button>
            <button class="tab-btn" data-tab="subscriber-tracking">구독자 수 추적</button>
            <button class="tab-btn" data-tab="thumbnail-test">썸네일테스트</button>
        </nav>

        <main class="main-content">

            <div id="channel-monitor" class="tab-content active">
                <!-- (생략없이 전체 코드) -->
                <div class="tab-header">
                    <h2>관심 채널 영상</h2>
                    <div class="tab-controls">
                        <select id="hot-video-ratio" class="tracking-sort-select compact-select" style="margin-right: 1rem;">
                            <option value="2">2배</option>
                            <option value="3">3배</option>
                            <option value="5">5배</option>
                            <option value="10">10배</option>
                            <option value="20">20배</option>
                        </select>
                        <button id="start-monitoring-btn" class="btn btn-primary">📈 채널 추적 시작</button>
                        <select id="tracking-sort-order" class="tracking-sort-select compact-select">
                            <option value="ratio">돌연변이</option>
                            <option value="publishedAt">최근 업로드</option>
                            <option value="subscriberCount">구독자 수</option>
                            <option value="viewCount">조회수</option>
                        </select>
                        <label class="show-all-toggle">
                            <input type="checkbox" id="show-all-channels">
                            <span>전체 채널 보기</span>
                        </label>
                        <button id="backup-tracking-data-btn" class="btn btn-secondary">💾 데이터 백업</button>
                        <input type="file" id="restore-tracking-data-input" accept=".txt,.json" style="display: none;">
                        <button id="restore-tracking-data-btn" class="btn btn-secondary">📁 데이터 복원</button>
                    </div>
                </div>

                <div class="monitoring-channel-management">
                    <div class="management-header" data-section="monitoring">
                        <div class="management-title-section">
                            <h3>등록된 채널 관리 (모니터링)</h3>
                            <button class="collapse-btn" id="monitoring-collapse-btn">▼</button>
                        </div>
                        <div class="management-controls" onclick="event.stopPropagation()">
                            <button id="add-monitoring-channel-btn" class="btn btn-primary">+ 채널 추가</button>
                            <span class="channel-count">총 <span id="monitoring-channel-count">0</span>개 채널</span>
                        </div>
                    </div>
                    <div id="monitoring-channel-grid"></div>
                </div>

                <div class="tracking-records" id="tracking-records">
                    <div class="empty-state">
                        <p>채널을 추가하고 추적을 시작해보세요.</p>
                        <button class="btn btn-primary" onclick="document.getElementById('add-monitoring-channel-btn').click()">
                            첫 번째 채널 추가하기
                        </button>
                    </div>
                </div>

                <div class="subscriber-management">
                    <h3 style="margin-bottom: 1rem; color: #333;">등록된 채널 최신 영상</h3>
                    <div class="search-results" id="latest-videos-container">
                        <div class="empty-state">
                            <p>등록된 채널이 없습니다.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="video-search" class="tab-content">
    <div class="tab-header">
        <h2>영상 검색</h2>
    </div>
    <div class="search-form">
        <input type="text" id="search-keyword" placeholder="검색 키워드를 입력하세요">
        <button id="search-btn" class="btn btn-primary">검색</button>
    </div>
    <div class="search-results" id="search-results">
        <div class="empty-state">
            <p>검색 조건을 입력하고 검색해보세요.</p>
        </div>
    </div>
</div>

		<div id="subscriber-tracking" class="tab-content">
    <div class="tab-header">
        <h2>구독자 수 추적</h2>
        <button id="collect-subscriber-data-btn" class="btn btn-primary">📊 오늘 구독자 수 수집</button>
    </div>
    <div class="tracking-channel-management">
        <button id="add-tracking-channel-btn" class="btn btn-primary">+ 채널 추가</button>
        <span class="channel-count">총 <span id="tracking-channel-count">0</span>개 채널</span>
        <div id="tracking-channel-grid"></div>
    </div>
    <div class="subscriber-management">
        <div id="subscriber-data-list">
            <div class="empty-state">
                <p>아직 기록된 데이터가 없습니다.</p>
                <p>상단의 "오늘 구독자 수 수집" 버튼을 눌러 시작해보세요.</p>
            </div>
        </div>
    </div>
    <div class="chart-container">
        <canvas id="subscriber-chart"></canvas>
    </div>
</div>

		<div id="thumbnail-test" class="tab-content">
    <div class="tab-header">
        <h2>썸네일 테스트</h2>
        <input type="text" id="test-keyword" placeholder="키워드 입력 (선택사항)">
        <button id="start-test-btn" class="btn btn-primary">테스트 시작</button>
    </div>
    <div id="test-intro">
        <p>썸네일 테스트 게임 안내...</p>
    </div>
    <div id="test-game" style="display:none;">
        <!-- 문제 및 선택지 UI가 JS에서 동적으로 추가됩니다 -->
    </div>
    <div id="test-result" style="display:none;">
        <!-- 최종 결과 UI가 JS에서 동적으로 추가됩니다 -->
    </div>
</div>

		

        </main>

        <!-- === 모달(검색 포함) === -->

        <!-- 채널 추가 모달 -->
        <div id="channel-modal" class="modal">
            <div class="modal-content">
                <h3>채널 추가</h3>
                <div class="channel-input-info">
                    <p>다음 중 하나를 입력하세요:</p>
                    <ul>
                        <li>채널명 (예: "채널이름")</li>
                        <li>채널 URL (예: youtube.com/@channelname)</li>
                        <li>채널 ID (예: UC...)</li>
                    </ul>
                </div>
                <input type="text" id="channel-input" placeholder="채널명, 채널 URL, 또는 채널 ID를 입력하세요">
                <div class="modal-buttons">
                    <button id="add-channel-confirm-btn" class="btn btn-primary">추가</button>
                    <button id="cancel-channel-btn" class="btn btn-secondary">취소</button>
                </div>
            </div>
        </div>

        <!-- *** 채널 검색 결과(선택) 모달 *** -->
        <div id="channel-selection-modal" class="modal">
            <div class="modal-content channel-selection-content">
                <h3>채널 선택</h3>
                <p class="channel-selection-description">여러 개의 채널이 검색되었습니다. 추가할 채널을 선택해주세요:</p>
                <!-- 반드시 이 div의 id/class를 유지하세요! -->
                <div class="channel-selection-list" id="channel-selection-list"></div>
                <div class="modal-buttons">
                    <button id="cancel-channel-selection-btn" class="btn btn-secondary">취소</button>
                </div>
            </div>
        </div>

        <div id="loading-overlay" class="loading-overlay">
            <div class="loading-spinner"></div>
            <p>데이터를 불러오는 중...</p>
        </div>
    </div>

    <!-- 메인 JS -->
    <script type="module" src="js/main.js"></script>
    <script type="module" src="js/channel-monitor.js"></script>
    <script type="module" src="js/video-search.js"></script>
    <script type="module" src="js/subscriber-tracking.js"></script>
    <script type="module" src="js/thumbnail-test.js"></script>
</body>
</html>
